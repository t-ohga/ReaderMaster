# 編集機能要件

## 📋 概要

このディレクトリは、キャンバス上のオブジェクトを編集するための機能要件を定義します。テキスト、表、図形の編集と、共通的なオブジェクト操作機能で構成されます。

### サブディレクトリ構成
- `text_editing/` - テキストオブジェクトの編集機能
- `table_editing/` - 表オブジェクトの編集機能
- `shape_editing/` - 図形オブジェクトの編集機能
- `object_manipulation/` - 共通オブジェクト操作（移動、リサイズ、回転等）

## 🎯 検討すべきこと

### 1. テキスト編集機能
- [ ] インライン編集（ダブルクリックで編集モード）
- [ ] リッチテキスト対応（太字、斜体、下線）
- [ ] フォント選択（種類、サイズ、色）
- [ ] テキスト配置（左揃え、中央、右揃え、両端）
- [ ] 行間・文字間隔の調整
- [ ] テキストボックスの自動リサイズ
- [ ] Undo/Redo対応

### 2. 表編集機能
- [ ] セル内容の編集
- [ ] 行・列の追加・削除
- [ ] セルの結合・分割
- [ ] 列幅・行高の調整
- [ ] セルスタイル（背景色、罫線）
- [ ] ヘッダー行/列の固定
- [ ] ソート・フィルター機能（将来的に）

### 3. 図形編集機能
- [ ] 図形の種類（矩形、円、線、多角形）
- [ ] 色変更（塗りつぶし、境界線）
- [ ] 透明度調整
- [ ] 線のスタイル（実線、破線、太さ）
- [ ] 角の丸み調整
- [ ] グラデーション対応（Phase 2以降）

### 4. オブジェクト共通操作
- [ ] 選択（単一、複数）
- [ ] 移動（ドラッグ&ドロップ）
- [ ] リサイズ（8方向ハンドル）
- [ ] 回転（ハンドル or 数値指定）
- [ ] コピー＆ペースト
- [ ] 削除
- [ ] レイヤー順序変更（最前面、最背面等）
- [ ] グループ化・グループ解除
- [ ] 整列・分散配置
- [ ] ロック機能（編集防止）

## ✅ 完了の基準

各編集機能が以下の状態に達していること：

1. **直感的な操作性** - ユーザビリティテストで90%以上が操作可能
2. **レスポンス性能** - 編集操作の反映が100ms以内
3. **データ整合性** - 編集内容が確実に保存される
4. **エラー防止** - 誤操作の取り消しが可能（Undo機能）
5. **アクセシビリティ** - キーボード操作のみでも編集可能

## 📝 テンプレート：編集機能仕様書

```markdown
## [編集機能名] 仕様

### 基本情報
- 対象オブジェクト: [テキスト/表/図形/共通]
- 優先度: [High/Medium/Low]
- MVP対応: [Yes/No]

### 操作フロー
**編集開始**
1. [トリガー操作]
2. [UI変化]
3. [編集可能状態]

**編集中**
- [操作1]: [効果]
- [操作2]: [効果]
- [操作3]: [効果]

**編集確定**
- [確定方法]
- [保存タイミング]

### UI仕様
**編集ツールバー**
- [ツール1]: [アイコン/機能]
- [ツール2]: [アイコン/機能]

**インタラクション**
- マウス: [動作]
- キーボード: [ショートカット]
- タッチ: [ジェスチャー]

### データ変更
**変更前**
```json
{
  "type": "...",
  "properties": { ... }
}
```

**変更後**
```json
{
  "type": "...",
  "properties": { ... },
  "edited": true,
  "editedAt": "timestamp"
}
```

### パフォーマンス要件
- 編集反映: [目標時間]ms
- 描画更新: [FPS]
- メモリ使用: [上限]

### テストケース
- [ ] 正常編集: [シナリオ]
- [ ] 複数選択編集: [シナリオ]
- [ ] 境界値: [シナリオ]
- [ ] Undo/Redo: [シナリオ]
- [ ] 同時編集競合: [シナリオ]
```

## 🔗 関連ドキュメント

### 上位ドキュメント
- [../README.md](../README.md) - 機能全体の概要
- [../core_functions/](../core_functions/) - コア機能（オブジェクト管理の基盤）

### UX設計
- [../../04_ux_design/interaction_patterns/](../../04_ux_design/interaction_patterns/) - インタラクションパターン
- [../../04_ux_design/visual_design/](../../04_ux_design/visual_design/) - ビジュアルデザイン
- [../../04_ux_design/accessibility/](../../04_ux_design/accessibility/) - アクセシビリティ

### 技術仕様
- [../../05_technical/architecture/](../../05_technical/architecture/) - フロントエンド設計
- [../../05_technical/api_design/](../../05_technical/api_design/) - 編集API設計

### 開発・テスト
- [../../09_development/testing/](../../09_development/testing/) - E2Eテスト計画

## 📌 重要な注意事項

### MVP対応優先順位
1. **Phase 1 (MVP)**:
   - テキスト基本編集（フォント、サイズ、色）
   - オブジェクト移動・リサイズ
   - 削除・Undo

2. **Phase 2**:
   - 表編集（セル編集、行列追加）
   - 図形編集（色、線スタイル）
   - グループ化・整列

3. **Phase 3**:
   - リッチテキスト（書式、リスト）
   - 高度な表機能（ソート、フィルター）
   - グラデーション、影効果

### パフォーマンス目標値
- **編集操作反映**: 100ms以内
- **キャンバス再描画**: 60fps維持
- **Undo履歴**: 最大50アクション
- **オブジェクト選択**: 10ms以内で視覚フィードバック

### ユーザビリティ原則
1. **即座のフィードバック**: 操作後すぐに視覚的変化
2. **予測可能な動作**: 一般的なツール（Figma, Canva）と同様の操作感
3. **エラー許容**: Undo/Redoで簡単に取り消し可能
4. **キーボードショートカット**: 頻繁な操作は Ctrl+Z（Undo）等で高速化

### 実装時の注意点
- **状態管理**: 編集中の状態を適切に管理（React state or Zustand）
- **イベント処理**: マウス/タッチイベントの適切な処理
- **描画最適化**: Canvas/SVGの効率的な更新
- **データ同期**: 編集内容のバックエンド保存タイミング
