# インタラクションパターン要件

## 📋 概要

このディレクトリは、ユーザーとシステムの対話方法を定義します。直感的で効率的な操作体験を提供するためのインタラクションパターンを標準化します。

### 主要パターン
- **ドラッグ&ドロップ** - ファイルアップロード、オブジェクト移動
- **ズーム/パン** - キャンバスナビゲーション
- **選択操作** - 単一/複数オブジェクト選択
- **コンテキストメニュー** - 右クリックメニュー
- **ショートカット** - キーボード操作
- **ジェスチャー** - タッチデバイス対応

## 🎯 検討すべきこと

### 1. ドラッグ&ドロップパターン
- [ ] **ファイルアップロード**
  - ドロップゾーンの視覚的フィードバック
  - ドラッグ中のプレビュー表示
  - 複数ファイルの一括ドロップ
  - 対応形式の判定とエラー表示

- [ ] **オブジェクト移動**
  - スムーズなドラッグ動作（60fps）
  - グリッドスナップ（オプション）
  - ガイドライン表示（整列補助）
  - 複数選択時の同時移動

### 2. ズーム/パンパターン
- [ ] **ズーム操作**
  - マウスホイール: スクロールでズーム
  - ピンチ: タッチデバイスでピンチイン/アウト
  - ショートカット: Ctrl + (+/-) でズーム
  - ズーム範囲: 10% ～ 500%
  - ズーム中心: カーソル位置を基準

- [ ] **パン操作**
  - スペースキー + ドラッグ
  - マウス中ボタンドラッグ
  - 2本指スワイプ（タッチ）
  - 端までスクロール時の自動拡張

### 3. 選択操作パターン
- [ ] **単一選択**
  - クリックで選択
  - 選択状態の視覚フィードバック（枠線、ハンドル表示）
  - 別オブジェクトクリックで選択切替

- [ ] **複数選択**
  - Shift + クリック: 追加選択
  - Ctrl + クリック: 選択トグル
  - ドラッグ範囲選択（矩形領域）
  - 全選択: Ctrl + A

- [ ] **選択解除**
  - 空白エリアクリック
  - Escキー
  - 選択解除の明確なフィードバック

### 4. コンテキストメニュー
- [ ] **メニュー表示**
  - 右クリックでメニュー展開
  - カーソル位置に追従
  - 画面外にはみ出さない位置調整

- [ ] **メニュー項目**
  - オブジェクト種別に応じた項目表示
  - 無効な操作はグレーアウト
  - ショートカット表示（例: Delete - Del）
  - アイコン付きで視認性向上

### 5. キーボードショートカット
- [ ] **基本操作**
  - Ctrl + Z: Undo
  - Ctrl + Y / Ctrl + Shift + Z: Redo
  - Ctrl + C/V/X: コピー/ペースト/カット
  - Delete: 削除

- [ ] **編集操作**
  - Ctrl + D: 複製
  - Ctrl + G: グループ化
  - Ctrl + Shift + G: グループ解除
  - 矢印キー: 1px移動
  - Shift + 矢印: 10px移動

- [ ] **表示操作**
  - Ctrl + 0: 100%表示
  - Ctrl + 1: 実寸表示
  - Ctrl + 2: フィット表示

### 6. タッチジェスチャー（モバイル/タブレット）
- [ ] **基本ジェスチャー**
  - タップ: 選択
  - ロングタップ: コンテキストメニュー
  - ピンチ: ズーム
  - 2本指スワイプ: パン

- [ ] **編集ジェスチャー**
  - ダブルタップ: 編集モード
  - 2本指回転: オブジェクト回転
  - ドラッグ: 移動

## ✅ 完了の基準

各インタラクションパターンが以下を満たすこと：

1. **応答性**: 操作後100ms以内に視覚フィードバック
2. **一貫性**: 類似操作で同様の動作を保証
3. **発見可能性**: 操作方法がUIから自然に理解できる
4. **エラー許容**: 誤操作の取り消しが容易
5. **アクセシビリティ**: キーボードのみでも全操作可能

## 📝 テンプレート：インタラクション仕様書

```markdown
## [インタラクション名] 仕様

### 基本情報
- カテゴリ: [ドラッグ&ドロップ/ズーム/選択/etc.]
- 対応デバイス: [マウス/タッチ/キーボード]
- 優先度: [High/Medium/Low]

### 操作定義
**トリガー**
- [操作方法]

**動作フロー**
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

**視覚フィードバック**
- 操作中: [UI変化]
- 完了時: [UI変化]
- エラー時: [UI変化]

### 詳細仕様
**パラメータ**
| 項目 | 値 | 説明 |
|------|-----|------|
| 応答時間 | [ms] | 操作反映までの時間 |
| 感度 | [値] | 操作の感度設定 |

**制約事項**
- [制約1]
- [制約2]

### デバイス別対応
**マウス**
- [操作方法と動作]

**タッチ**
- [ジェスチャーと動作]

**キーボード**
- [ショートカットと動作]

### エラーハンドリング
| エラー | 発生条件 | ユーザー表示 |
|--------|---------|-------------|
| [エラー1] | [条件] | [メッセージ/UI] |

### テストケース
- [ ] 正常操作: [シナリオ]
- [ ] 連続操作: [シナリオ]
- [ ] 境界値: [シナリオ]
- [ ] エラー: [シナリオ]
- [ ] アクセシビリティ: [シナリオ]
```

## 🔗 関連ドキュメント

### 上位ドキュメント
- [../README.md](../README.md) - UXデザイン全体の概要
- [../../03_features/editing/](../../03_features/editing/) - 編集機能（操作対象）

### デザイン仕様
- [../visual_design/](../visual_design/) - ビジュアルフィードバック設計
- [../accessibility/](../accessibility/) - アクセシビリティ対応

### 技術実装
- [../../05_technical/architecture/](../../05_technical/architecture/) - フロントエンド実装
- [../../09_development/testing/](../../09_development/testing/) - E2Eテスト（操作検証）

## 📌 重要な注意事項

### MVP対応優先順位
1. **Phase 1 (MVP)**:
   - ドラッグ&ドロップ（ファイル、オブジェクト）
   - ズーム/パン（マウスホイール、スペースキー）
   - 基本選択（クリック、Shift/Ctrl選択）
   - 主要ショートカット（Undo, Copy/Paste, Delete）

2. **Phase 2**:
   - コンテキストメニュー
   - 範囲選択
   - グリッドスナップ
   - 追加ショートカット

3. **Phase 3**:
   - タッチジェスチャー完全対応
   - 高度なスナップ機能
   - カスタムショートカット設定

### パフォーマンス目標値
- **ドラッグ操作**: 60fps（16.6ms/frame）
- **ズーム操作**: 100ms以内に反映
- **選択フィードバック**: 50ms以内
- **ショートカット応答**: 100ms以内

### デザイン原則
1. **即座のフィードバック**: 操作開始時点で視覚的変化
2. **予測可能性**: 業界標準（Figma, Adobe製品）に準拠
3. **柔軟性**: マウス/キーボード/タッチで同等の操作性
4. **エラー防止**: ガイド表示、スナップ機能で正確な操作を支援

### 参考ベンチマーク
- **Figma**: ドラッグ&ドロップ、ショートカット
- **Canva**: 初心者向けの直感的操作
- **Adobe XD**: ズーム/パン操作
- **Google Docs**: キーボードショートカット体系

### 実装時の技術的考慮
- **イベント処理**: passive listenerで性能向上
- **デバウンス/スロットル**: 過度なイベント発火を制御
- **タッチ対応**: Pointer Events APIで統一的な実装
- **アクセシビリティ**: ARIA属性、フォーカス管理の適切な実装
